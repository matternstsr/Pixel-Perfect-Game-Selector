<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="styles/style.css"/>
  <title>Pixel Perfect Pairing - Ultimate Game Matcher</title>
</head>
<body>
  <h1 class='titleName'>Pixel Perfect<br>Gift Selector</h1>
  <div class="questions">
    <!-- First Section -->
    <div class="box">
      <h3>You wake up in the morning and it's snowing! What do you do first?</h3>
      <form>
        <label>
          <input type="radio" name="console" value= '0' > Call friends and family. <!-- Nintendo  -->
        </label>
        <label>
          <input type="radio" name="console" value='5'> Prepare to spend the day watching sports. <!-- Xbox  -->
        </label>
        <label>
          <input type="radio" name="console" value='10'> Bundle up on the couch, and find a good movie. <!-- PlayStation  -->
        </label>
        <label>
          <input type="radio" name="console" value='15'> Get dressed and sprint outside! <!-- Mobile  -->
        </label>
        <label>
          <input type="radio" name="console" value='20'> Check the weather, and plan out my day accordingly. <!-- PC  -->
      </form>
    </div>

    <!-- Second Section -->
    <div class="box">
      <h3>After Breakfast, you are walking down the road and find yourself in a snowball fight! What's your move?</h3>
      <form>
        <label>
          <input type="radio" name="playerOptions" value='1'> Ignore it, you've got better things to do. <!-- Single  -->
        </label>
        <label>
          <input type="radio" name="playerOptions" value='2'> Join in! It's everyone for themselves! <!-- Multiplayer  -->
        </label>
      </form>
    </div>

    <!-- Third Section -->
    <div class="box">
      <h3>A dragon is guarding a hoard of presents! What do you do?</h3>
      <form>
        <label>
          <input type="radio" name="dragonAction" value='0'> Pull out the +5 Broadsword you keep with you.
        </label>
        <label>
          <input type="radio" name="dragonAction" value='1'> Ask it it's name.
        </label>
        <label>
          <input type="radio" name="dragonAction" value='2''> Challenge it to a duel.
        </label>
        <label>
          <input type="radio" name="dragonAction" value='3'> Cast magic missile into the darkness?
        </label>
        <label>
          <input type="radio" name="dragonAction" value='3'> Scream in terror and run away!
        </label>
      </form>
    </div>

    <!-- Fourth Section -->
    <div class="box">
      <h3>You defeat the dragon, but the first present you open begins to tick, what do you do?</h3>
      <form>
        <label>
          <input type="radio" name="tickPresent" value='0'> Run as far away as you can!
        </label>
        <label>
          <input type="radio" name="tickPresent" value='1'> Close the door and wait.
        </label>
        <label>
          <input type="radio" name="tickPresent" value='2'> Rip it open, I'm not scared!
        <label>
          <input type="radio" name="tickPresent" value='3'> Try to disarm the present.
        </label>
        <label>
          <input type="radio" name="tickPresent" value='4'> Hide behind your friends you invited.
        </label>
      </form>
    </div>

    <!-- Fifth Section -->
    <div class="box">
      <h3>Its a clock!, The room is starting to collapse, what do you do?</h3>
      <form>
        <label>
          <input type="radio" name="roomCollapse" value='0'> Grab as many Presents as you can before running.
        </label>
        <label>
          <input type="radio" name="roomCollapse" value='1'> Look for a secret escape route.
        </label>
        <label>
          <input type="radio" name="roomCollapse" value='2'> Take the most optimized route out to be the fastest.
        </label>
        <label>
          <input type="radio" name="roomCollapse" value='3'> Take only the most expensive looking gift.
        </label>
        <label>
          <input type="radio" name="roomCollapse" value='4'> Panic!
        </label>
      </form>
    </div>

    <!-- Sixth selection --> 
    <div class="box">
      <h3>You made it out! How would you rank your day?</h3>
      <form>
        <label>
          <input type="radio" name="madeIt" value='0'> Amazing!
        </label>
        <label>
          <input type="radio" name="madeIt" value='1'> The Best Ever!
        </label>
        <label>
          <input type="radio" name="madeIt" value='2'> Unbeatable!
        </label>
        <label>
          <input type="radio" name="madeIt" value='3'> Awesome!
        </label>
        <label>
          <input type="radio" name="madeIt" value='4'> Incredible!
        </label>
      </form>
    </div>
  </div>
  <button class='showGameButton' onclick="showMyGame()"><h3>Show My Game</h3></button>
    <!-- Add a new button for taking the quiz again -->
  <button class='takeQuizAgain' onclick="takeQuizAgain()"><h3>Take Quiz Again</h3></button>
  <div id="matchedGameHeader"></div>
  <div id="unmatchedGameHeader"></div>
  <div id="gameDetails"></div>
  
  <script>
    function showMyGame() {
      // Hide the .questions div
      const questionsDiv = document.querySelector('.questions');
      questionsDiv.style.display = 'none';
    
      // Show the "Take Quiz Again" button
      const takeQuizAgainButton = document.querySelector('button:last-of-type');
      takeQuizAgainButton.style.display = 'block'; // Change this line
    
      // Hide the "Show My Game" button
      const showGameButton = document.querySelector('button:first-of-type');
      showGameButton.style.display = 'none';

      let gameName1 = ['The Legend of Zelda: Tears of the Kingdom', 'Metroid Prime Remastered', 'Super Mario Odyssey', 'Pokemon Scarlet and Violet', 'The Legend of Zelda', 'Red Dead Redemption 2', 'Fallout 4', 'Minecraft Legends', 'Halo Infinite', 'Cuphead', 'Marvels Spider-Man', 'Gotham Knights', 'Final Fantasy VII Remake', 'Dungeons & Dragons: Dark Alliance', 'The Medium', 'Candy Crush Saga', 'Monument Valley 2', 'Asphalt 9: Legends', '2Fuse', 'Altos Adventure', 'Red Dead Redemption 2', 'Hollow Knight', 'Mass Effect Legendary Edition', 'Hogwarts Legacy', 'Grand Theft Auto 5'];
      let gameName2 = ['Nintendo Switch Sports', 'Super Smash Bros Ultimate', 'Mario Kart 8 Deluxe', 'Splatoon 3', 'Overcooked All You Can Eat', 'Rocket League', 'Apex Legends', 'Fortnite', 'Diablo 4', 'Destiny 2', 'Fortnite', 'Call of Duty Warzone', 'Street Fighter 6', 'No Mans Sky', 'FIFA 23', 'Souls', 'Marvels Strike Force', 'Pocket Card Jockey', 'Honkai Star Rail', 'Words with Friends 2', 'Diablo 4', 'Portal 2', 'Dead by Daytime', 'Valorant', 'World of Warcraft'];
      let resultsDA = 0;
      let resultsTP = 0;
      let resultsRC = 0;
      let resultsCC = 0;
      let numps = 0;
      let gameName = gameName2;
      const consoleChoice = document.querySelector('input[name="console"]:checked');
      const playerOptionsChoice = document.querySelector('input[name="playerOptions"]:checked');
      const roomCollapse = document.querySelector('input[name="roomCollapse"]:checked');
      const tickPresentChoice = document.querySelector('input[name="tickPresent"]:checked');
      const dragonActionChoice = document.querySelector('input[name="dragonAction"]:checked');
      const matchedGameHeader = document.getElementById('matchedGameHeader');
      const unmatchedGameHeader = document.getElementById('unmatchedGameHeader');
      const gameDetailsContainer = document.getElementById('gameDetails');


      if (dragonActionChoice.checked) {
        numps = dragonActionChoice.value};
      
      if (tickPresentChoice.checked) {
        resultsTP = tickPresentChoice.value};
      
      if (roomCollapse.checked) {
        resultsRC = roomCollapse.value};
      
      if (consoleChoice.checked) {
        resultsCC = consoleChoice.value};
      
      if (numps > resultsTP)(numps--)
      
      if (numps < resultsTP)(numps++)
      
      if (numps > resultsRC)(numps--)
      
      if (numps < resultsRC)(numps++)
      
      if (numps > 4)(numps = 4)

      if (numps < 0)(numps = 0)

      numps = Number(numps) + Number(resultsCC);
      if (playerOptionsChoice.value === '1')
        gameName = gameName1;
      else
        gameName = gameName2;
      fetchGameDetails(gameName[numps]);
    }

    function takeQuizAgain() {
      // Show the .questions div
      const questionsDiv = document.querySelector('.questions');
      questionsDiv.style.display = 'block';
    
      // Show the "Show My Game" button
      const showGameButton = document.querySelector('button:first-of-type');
      showGameButton.style.display = 'block';
    
      // Hide the "Take Quiz Again" button
      const takeQuizAgainButton = document.querySelector('button:last-of-type');
      takeQuizAgainButton.style.display = 'none';
    
      // Clear any previous game details
      document.getElementById('matchedGameHeader').innerHTML = '';
      document.getElementById('unmatchedGameHeader').innerHTML = '';
      document.getElementById('gameDetails').innerHTML = '';
    }

    function fetchGameDetails(gameName) {
      // Fetch game details based on the provided gameName
      fetch(`http://localhost:3000/api/games?search=${gameName}`)
        .then(response => response.json())
        .then(data => {
          if (data.results && data.results.length > 0) {
            const game = data.results[0];
            const gameHtml = `
              <h2>${game.name}</h2>
              <img class='gameImage' src="${game.background_image}" alt="${game.name}">
              <h3>Platforms:</h3>
              <h4 id="gameName">${game.name}</h4> <!-- Displaying gameName here -->
              <ul>
                ${game.platforms.map(platform => `
                  <li>${platform.platform.name} (Released at: ${platform.released_at})</li>
                  <ul>
                    <li>Minimum Requirements: ${platform.requirements ? platform.requirements.minimum : 'Not available'}</li>
                    <li>Recommended Requirements: ${platform.requirements ? platform.requirements.recommended : 'Not available'}</li>
                  </ul>
                `).join('')}
              </ul>
            `;
            document.getElementById('gameDetails').innerHTML = gameHtml;
          } else {
            document.getElementById('gameDetails').innerHTML = '<p>No game found with that name.</p>';
          }
        })
        .catch(error => {
          console.error('Error fetching game details:', error);
          document.getElementById('gameDetails').innerHTML = '<p>Error fetching game details. Please try again later.</p>';
        });
    }
    
  </script>
</body>
</html>